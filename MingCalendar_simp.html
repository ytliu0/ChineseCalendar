<!DOCTYPE html><html lang="zh"><meta charset="UTF-8"><meta name="keywords" content="中国历法, 农历, 大统历, 历法计算"><meta name="viewport" content="width=device-width,initial-scale=1"><head><title>明朝的定朔计算及历表朔日订正</title><link rel="stylesheet" href="calendar_chinese_min.css"><script src="header_min.js"></script><style>body{counter-reset:sec-counter}sect{counter-reset:subsec-counter}sect::before{counter-increment:sec-counter 1;content:counter(sec-counter) ". "}table.compact td,table.compact th{padding:3px;text-align:center}.error{color:red}.mismatch{color:brown}</style><base href="https://ytliu0.github.io/ChineseCalendar/"><script async src="https://www.googletagmanager.com/gtag/js?id=G-SN0QJRDXXT"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-SN0QJRDXXT")</script></head><body><div id="wrapper0" style="display:none"><div id="menu"></div><div id="language"></div><h1>明 朝 《大 统 历》 的 定 朔 计 算 及 历 表 朔 日 订 正</h1><p>初稿: 2019年8月</p><br><h3>摘 要</h3><br><p>本文根据《大统历》的推步方法计算明朝合朔和二十四节气时刻，发现与现存若干明代《大统历》历书给出的时刻完全吻合。比较算出的明朝二百七十六年间朔日和节气日期，发现节气日期完全符合张培瑜《三千五百年历日天象》<sup><a href="MingCalendar_simp.html#Zhang1997"></a></sup>的资料，但有十一个朔日不合，其中有七例证实是《三千五百年历日天象》的错误，这七个错误也见于薛仲三、欧阳颐的《两千年中西历对照表》<sup><a href="MingCalendar_simp.html#Hsueh"></a></sup>、陈垣的《二十史朔闰表》<sup><a href="MingCalendar_simp.html#Chen1962"></a></sup>及汪曰桢的<a href="https://ctext.org/library.pl?if=gb&res=2969&remap=gb" target="_blank">《历代长术辑要》</a>。</p><br><div style="border:1px solid #000;padding:10px"><p><b>内容</b></p><ol><li><a href="MingCalendar_simp.html#introduction">引 言</a></li><li><a href="MingCalendar_simp.html#theory">《大 统 历》 的 定 朔 计 算</a></li><li><a href="MingCalendar_simp.html#conjunctions">合 朔 时 刻 检 验</a></li><li><a href="MingCalendar_simp.html#corrections">历 表 朔 日 订 正</a></li></ol>&nbsp;&nbsp;&nbsp;<a href="MingCalendar_simp.html#references">参 考 文 献</a></div><br><sect id="introduction">引 言</sect><p>本网站的古代中历资料几乎全部采用张培瑜《三千五百年历日天象》<sup><a href="MingCalendar_simp.html#Zhang1997"></a></sup>的资料，除了该书外，还有其他中国史历表供史学家参考，例如薛仲三、欧阳颐的《两千年中西历对照表》<sup><a href="MingCalendar_simp.html#Hsueh"></a></sup>、陈垣的《二十史朔闰表》<sup><a href="MingCalendar_simp.html#Chen1962"></a></sup>及汪曰桢的<a href="https://ctext.org/library.pl?if=gb&res=2969&remap=gb" target="_blank">《历代长术辑要》</a>等。台湾中央研究院的<a href="http://sinocal.sinica.edu.tw/" target="_blank">两千年中西历转换</a>的古代中历资料就是<a href="http://sinocal.sinica.edu.tw/lusodoc.html" target="_blank">取自薛仲三、欧阳颐的《两千年中西历对照表》</a>。翻查这几本中国史历表，有时会发现历日有差异，笔者不是史学专家，难以考证孰是孰非，但认为最妥当的方法是考察当时政府颁行的历书。</p><p>中国历朝都视颁行历书为皇权的象征，历代都禁止民间藏用私历，藩属国也以中国颁行的历书纪日。在分裂时代，各政权都各自颁历，而不同历书所载的朔日和二十四节气日期不尽相同。因此中国史历表的资料应尽量用当时历书的资料，但是古代的历谱太部分已散失，明朝中叶以来的历谱却有很多现在还可以找到，对于辨明历表的正误很有用，本文集中研究明朝《大统历》历书。台湾的中央图书馆收藏了不少明朝《大统历》历书，历书首页图片可在台湾中央研究院数位文化中心的<a href="http://catalog.digitalarchives.tw/Search/Search.jsp?QS=%B5%BD%A5%BB%A5j%C4y%20%A4l%B3%A1%20%BE%E4%BA%E2%C3%FE%20%BE%E4%AAk%A4%A7%C4%DD" target="_blank">典藏台湾</a>找到，<a href="https://www.wdl.org/zh/" target="_blank">世界数字图书馆</a>有整本<a href="https://www.wdl.org/zh/item/108/" target="_blank">《大明嘉靖三年大统历》</a>，北京图书馆出版的《国家图书馆藏明代大统历日汇编》(全六册)<sup><a href="MingCalendar_simp.html#compilation"></a></sup>(以下简称《汇编》)更收集了从明正统十一年(1446年)至崇祯十四年(1641年)之间99种历书，<a href="MingCalendar_index.html">此网页</a>列出了六册书收集的历书目录。但是由于年代久远，《汇编》里很多历书受到不同程度的破损，或有虫蛀、或页面缺损、或字迹模糊、或内页缺失，但也有一些保留得很好的。《汇编》及上述网站收集的大统历书对于研究明朝《大统历》很有价值。</p><p>《大统历》各年历书的结构相同，封面印有历书的年份。封面或内页有伪造历书警句:</p><blockquote><p>钦天监凑淮印造大统历日颁行天下</p><p>伪造者依律处斩，有能告捕者官给赏银五十两，如无本监历日印信即同私历。</p></blockquote><p>历书的正文是首两页载有每月朔日和二十四节气时刻，后两页是「年神方位之图」(或称「九宫图」)，应是用于风水，接着数十页是当年的日历:每日一栏载有宜与不宜之事(今天视之为迷信的东西)，最后数页列出前六十年的纪年。本文要探讨的问题基本上只会用到历书首两页载的合朔资料。</p><p>细看这些存世的大统历谱(例如<a href="http://catalog.digitalarchives.tw/item/00/07/ec/c1.html" target="_blank">万历三年大统历首页</a>)，发现不但有朔日和二十四节气日期，还列出二十四节气的时刻，有少数历谱(例如<a href="http://catalog.digitalarchives.tw/item/00/07/ec/d6.html" target="_blank">崇祯二年大统历</a>)也列出合朔时刻，这些资料对研究大统历的定朔及节气计算很有价值。笔者看到这些资料后马上检查我的《大统历》推步结果，发现果然完全符合历谱所列的时刻。其实李勇在「明嘉靖六年《大统历》历书的气朔推步精度」<sup><a href="MingCalendar_simp.html#Li2011"></a></sup> 一文已指出《嘉靖六年大统历》历书的节气时刻和推步结果完全一致，但是该文并没有比较明朝历书的合朔时刻。笔者发现历书给出的合朔和节气时刻和《大统历》推步结果完全一致，除了感到高兴外也使我想起一事。</p><p>两个月前笔者编写了大统历的合朔和节气推步程式后，曾将结果与《三千五百年历日天象》的资料比对，发现在明朝洪武二年(1369年)到崇祯十七年(1644年)二百七十六年间，二十四节气的日期完全符合《三千五百年历日天象》，但是朔日却有十一处不合。当时我不以为意，因为古代的日历不一定按术文计算的，有时历官可能会稍为调整计算方法，或短暂采用其他历法，或因忌讳而修改历日(详见黄一农「中国史历表朔闰订正举隅」<sup><a href="MingCalendar_simp.html#Huang1992a"></a></sup>)，而这些改动不一定全都记载于史书中。现在发现推步结果不但日期符合大统历书，连时刻也都吻合，显示笔者的推步方法确是与当时历官采用的方法一致，既然有不少明朝历书仍存世，何不找出当年的大统历谱看看那十一处不合究竟是谁对谁错?结果发现竟然有七个是《三千五百年历日天象》错了，余下的四个不合因为找不到资料而无从判断，这考察结果会在本文最后一节叙述。奇怪的是这七个错误也见于汪曰桢的《历代长术辑要》、陈垣的《二十史朔闰表》及薛仲三、欧阳颐的《两千年中西历对照表》，三书列出的那十一个朔日都与《三千五百年历日天象》完全一样，说明了即使各历表的历日一致也不能保证一定符合实历。</p><p>由于李勇在<a href="MingCalendar_simp.html#Li2011"></a>已比较了《大统历》的节气推步和历书给出的时刻，本文不再重复比较节气时刻，而集中比较《大统历》的定朔推步和历书给出的时刻。李勇在<a href="MingCalendar_simp.html#Li2011"></a>文中指出《大统历》的定朔有两种不同计算方法，究竟《大统历》采用哪个方法计算定朔，或许可考察大统历书载的合朔时刻断定，这是下面两节要探讨的问题。</p><p>大统历也用于编制南明及明郑的历书，但从其历日得知算法稍有不同，这点我在<a href="SouthernMingCalendar_simp.html">「南明和明郑历法的朔闰」</a>一文稍有分析。清朝在康熙六年至八年因历狱停用时宪历，短暂復用大统历，这几年清朝历书所载的月相和节气时刻在拙文<a href="http://ytliu.epizy.com/Shixian/N1667_1669_simp.html" target="_blank">「康熙六年至八年(1667-1669)的月相和节气时刻」</a>也有分析。</p><br><sect id="theory">《大 统 历》 的 定 朔 计 算</sect><p>明朝《大统历》基本上沿袭元朝《授时历》的法数和推步方法。《授时历》的推步方法在李勇和张培瑜于1996年和李勇及张承志于1998年发表的两篇文章(<a href="MingCalendar_simp.html#LiZhang1996"></a>和<a href="MingCalendar_simp.html#LiZhang1998"></a>)有介绍，这里就不叙述了，但会简略介绍定朔的一般计算，以便说明《授时历》和《大统历》在计算定朔时可能有一些差异。</p><p>合朔的定义是月亮视黄经和太阳视黄经相等的时刻。用<span class="nowrap">&lambda;<sub>M</sub></span>表示月亮视黄经、<span class="nowrap">&lambda;<sub>s</sub></span>表示太阳视黄经，则合朔时刻t满足方程<br>f(t)=<span class="nowrap">&lambda;<sub>M</sub></span>(t)-<span class="nowrap">&lambda;<sub>s</sub></span>(t)=0 &nbsp;&nbsp;&nbsp;(1)<br>现代天文的其中一个计算方法是用牛顿-拉弗森(Newton-Raphson)求根法，这是一个迭代算法。设若<span class="nowrap">t<sub>n</sub></span>为第n次迭代的数值，则下一轮迭代的数值用以下公式计算:<br><span class="nowrap">t<sub>n+1</sub></span>=<span class="nowrap">t<sub>n</sub></span> - <span class="nowrap">f(t<sub>n</sub>)</span>/<span class="nowrap">f'(t<sub>n</sub>)</span>&nbsp;&nbsp;&nbsp;(2)<br>其中<span class="nowrap">f'</span>是f对时间的导数。如果选择起始值<span class="nowrap">t<sub>0</sub></span>为平朔时刻，则第一轮迭代的结果是<br><span class="nowrap">近似定朔时刻</span>=平朔时刻 - <span class="nowrap">f(平朔时刻)</span>/<span class="nowrap">f'(平朔时刻)</span>&nbsp;&nbsp;&nbsp;(3)&nbsp;&nbsp;&nbsp;<br>函数-f可以写成<br>-f(t)=(<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>M</sub></span>(t)-<span class="nowrap">&lambda;<sub>M</sub>(t)</span>) + (<span class="nowrap">&lambda;<sub>s</sub>(t)</span>-<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>s</sub>(t)</span>) + <span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>s</sub></span>(t)-<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>M</sub>(t)</span><br>其中<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>M</sub></span>和<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>s</sub></span>是月亮和太阳的平黄经，即只考虑日月平均运动得出的黄经。式中第一项<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>M</sub></span>-<span class="nowrap">&lambda;<sub>M</sub></span>称为「迟疾差」，第二项<span class="nowrap">&lambda;<sub>s</sub></span>-<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>s</sub></span>称为「盈缩差」。在平朔时刻，<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>M</sub></span>=<span class="nowrap"><span style="text-decoration:overline">&lambda;</span><sub>s</sub></span>，所以<br>-f(平朔时刻) = 迟疾差 + 盈缩差<br>f的导数是<br><span class="nowrap">f'(t)</span>=<span class="nowrap">&lambda;'<sub>M</sub>(t)</span>-<span class="nowrap">&lambda;'<sub>s</sub>(t)</span>=月实行速-日实行速<br>定朔的一次近似时刻可写成<br>定朔(近似)时刻 = 平朔时刻 + (迟疾差 + 盈缩差)/(月实行速 - 日实行速)&nbsp;&nbsp;(4)</p><p>中国古代的定朔计算公式与(4)式类似但不完全相同。《授时历》的定朔计算公式是<br>定朔时刻 = 平朔时刻 + 0.082&times;(迟疾差 + 盈缩差)/迟疾限行度&nbsp;&nbsp;&nbsp;(5)<br>= 平朔时刻 + (迟疾差 + 盈缩差)/月实行速<br>《授时历》取近点月(转终)为27.5546日，把近点月时间分为336限，所以一限=27.5546日/336=0.082日。古代一度定义为太阳一天在天空运行的平均角度，《授时历》行用其间取回归年为365.2425日，所以一圆周有365.2425度，换成今天采用的360&deg;制，《授时历》的一度相当于360&deg;/365.2425=0.9856&deg;。「迟疾限行度」是月亮在一限时间的实行度，因此迟疾限行度/0.082日就是以(度/日)为单位的月实行速。用月实行速代替(月实行速-日实行速)，理论上并不准确，却比以前的很多历法用月平行速代替(月实行速-日实行速)有些进步。</p><p>南宋杨忠辅发现回归年长度不是常量，《授时历》接受这观点，其回归年长度规定每一百年减万分之一日，称为「岁实消长」。但是《授时历》只用了88年就被后继的《大统历》取代，《大统历》虽然沿袭《授时历》法数和算法，但是取消了岁实消长法，回归年取常数365.2425日。《大统历》术文的定朔算法也和《授时历》稍有不同:<br>定朔时刻 = 平朔时刻 + 0.082&times;(迟疾差 + 盈缩差)/定限度&nbsp;&nbsp;&nbsp;(6)<br>= 平朔时刻 + (迟疾差 + 盈缩差)/(月实行速 - 日平行速)<br>其中定限度=迟疾限行度-0.082度=月亮在一限的实行度 - 太阳在一限的平行度，所以定限度/0.082就是以(度/日)为单位的(月实行速 - 日平行速)。以(月实行速-日平行速)代替月实行速，理论上虽然是进步了，但是据李勇<a href="MingCalendar_simp.html#Li2011"></a>的计算，这改动得出的合朔时刻精度反而不及《授时历》的计算精度，也不及宋代的平均水准。原因很可能是《授时历》制定的盈缩差和迟疾差计算公式以实测数据配合公式(5)的模型，如果要把公式(5)改为公式(6)，盈缩差和迟疾差计算公式也得修改才能符合实测数据。</p><p>李勇在其文章<a href="MingCalendar_simp.html#Li2011"></a>认为《大统历》的合朔计算仍然采用公式(5)，即和《授时历》一样，他指出邢云路《古今律历考》给出的《大统历》推算朔望和日月食的计算法都依照《授时历》的公式，所以《大统历》的术文可能刊误。既然有存世《大统历》历书载有合朔时刻，只要将那些时刻比较公式(5)和公式(6)算出的时刻，或可判别《大统历》采用的算法。下一节会叙述计算结果。</p><br><sect id="conjunctions">合 朔 时 刻 检 验</sect><p>笔者找到的存世《大统历》历书，有六部载有合朔时刻，其中有三部在典藏台湾找到<a href="MingCalendar_simp.html#fn0"></a>:<a href="http://catalog.digitalarchives.tw/item/00/07/ec/cb.html" target="_blank">《大明万历三十二年岁次甲辰大统历》</a>、<a href="http://catalog.digitalarchives.tw/item/00/07/ec/d6.html" target="_blank">《大明崇祯二年岁次己巳大统历》</a>及<a href="http://catalog.digitalarchives.tw/item/00/07/ec/da.html" target="_blank">《大明崇祯十二年岁次己卯大统历》</a>;其余三部在《国家图书馆藏明代大统历日汇编》第二册和第五册找到:《大明嘉靖十年岁次辛卯大统历》(《汇编(二)》157-158页)、《大明嘉靖十一年岁次壬辰大统历》(《汇编(二)》247-248页)及《大明万历四十四年岁次丙辰大统历》(《汇编(五)》281-282页)。《汇编(四)》也有万历三十二年的历书、《汇编(六)》也有崇祯十二年的历书，但是那两部历书没有合朔时刻。另外，《汇编(二)》有两部嘉靖十一年历书、《汇编(五)》有两部万历四十四年历书，也是一部有合朔时刻而另一部没有。可见在嘉靖十一年、万历三十二年、万历四十四年和崇祯十二年，大统历书至少有两个不同版本，其他年份可能也是如此。典藏台湾只有历书的首页六(或七)个合朔，三部历书共19个合朔资料。《汇编》所载的那三部历书有全年的合朔资料，三部历书共有37合朔，所以这六部历书合计有56个合朔。</p><p>历书中合朔的时刻以辰刻制给出，计算方法是1天=100刻=12辰，故一辰=100/12刻=8.3333刻，一刻=0.01日=14.4分钟。辰以十二地支子、丑、寅、卯、辰、巳、午、未、申、酉、戌、亥表示，用现在的24小时制来说，子是晚上23时到下一天的1时，丑是1时到3时等等。一辰又分为初和正两部分，例如寅初指3时到4时、寅正指4时至5时，子初指23时到0时、子正指0时到1时等。刻的计量取「落地算法」，即0-1刻间称为「初刻」，1-2刻间称为「一刻」，2-3刻称为「二刻」等。所以「亥初二刻」指21时28.8分到21时43.2分，写成日的小数就是0.895到0.905，或<span class="nowrap">0.900&pm;0.005</span>。同理，「未正三刻」指14:43.2到14:57.6，写成日的小数是0.613到0.623，或<span class="nowrap">0.618&pm;0.005</span>。因为半个时辰只比四刻多出1/6刻，所以「巳正四刻」较为特别，指10:57.6到11:00这2.4分钟时间，写成日的分数是0.4567到0.4583，或<span class="nowrap">0.4575&pm;0.0008</span>。把合朔时间写成日的小数，就是古代所称的朔小余。朔日的日干支可以用整数表示，这里以甲子为0、乙丑为1等，即干支网页<a href="sexagenary_chinese.html#sexagenary">表二</a>所载的干支次序减去一。这样合朔的干支日和时刻可以用数字表示，整数部分表示日干支(大余)，小数部分是朔小余。例如「辛巳未正三刻」是<span class="nowrap">17.618&pm;0.005</span>、「戊申亥初二刻 」是<span class="nowrap">44.900&pm;0.005</span>等，下表就是采用这方法把历书中的合朔时刻化成数字方便比较推步的结果。</p><p>笔者用「迟疾限行度」[公式(5)]和「定限度」[公式(6)]计算了明朝二百七十六年间所有合朔时刻，这里采用李勇<a href="MingCalendar_simp.html#Li2011"></a>标记，称「迟疾限行度」的算法为D1、称「定限度」的算法为D2。平朔时刻、迟疾差、盈缩差及迟疾限行度的计算方法依照<a href="MingCalendar_simp.html#LiZhang1996"></a>或<a href="MingCalendar_simp.html#LiZhang1998"></a>文章提供的公式，由于《大统历》废除了《授时历》的岁实消长法，那些公式里所有的<span class="nowwrap">A'</span>都要改为A。下表列出上述56个合朔的计算结果及大统历书给出的数据。</p><br><table><caption style="text-align:left"><p>表一:合朔时刻比较。合朔时刻的数字整数部分表示日干支(0=甲子、1=乙丑等)，小数部分是朔小余，即合朔离夜半零时的时间(以日为单位)。D1是依「迟疾限行度」算法得出的合朔时刻，D2是依「定限度」算法得出的时刻。棕色数字表示与《大统历》历书数据不合，红色数字表示朔日干支错了。</p></caption><tr><th rowspan="2">年 份</th><th rowspan="2">月 份</th><th colspan="3">合 朔 时 刻</th></tr><tr><th>《大统历》历书</th><th>D1</th><th>D2</th></tr><tr><td rowspan="13">嘉靖十年<br>(1531年)</td><td>正</td><td>丙戌亥正一刻 (22.932&pm;0.005)</td><td>22.931</td><td class="mismatch">22.968</td></tr><tr><td>二</td><td>丙辰未正二刻 (52.608&pm;0.005)</td><td>52.605</td><td class="mismatch">52.653</td></tr><tr><td>三</td><td>丙戌寅初二刻 (22.150&pm;0.005)</td><td>22.154</td><td class="mismatch">22.201</td></tr><tr><td>四</td><td>乙卯未正初刻 (51.588&pm;0.005)</td><td>51.590</td><td class="mismatch">51.628</td></tr><tr><td>五</td><td>甲申亥正二刻 (20.942&pm;0.005)</td><td>20.937</td><td class="mismatch">20.960</td></tr><tr><td>六</td><td>甲寅卯初一刻 (50.223&pm;0.005)</td><td>50.220</td><td>50.224</td></tr><tr><td>闰六</td><td>癸未午初三刻 (19.493&pm;0.005)</td><td>19.491</td><td class="mismatch">19.476</td></tr><tr><td>七</td><td>壬子戌初二刻 (48.817&pm;0.005)</td><td>48.814</td><td class="mismatch">48.783</td></tr><tr><td>八</td><td>壬午卯初初刻 (18.213&pm;0.005)</td><td>18.211</td><td class="mismatch">18.169</td></tr><tr><td>九</td><td>辛亥酉初初刻 (47.713&pm;0.005)</td><td>47.714</td><td class="mismatch">47.668</td></tr><tr><td>十</td><td>辛巳辰初三刻 (17.327&pm;0.005)</td><td>17.330</td><td class="mismatch">17.289</td></tr><tr><td>十一</td><td>辛亥丑初三刻 (47.077&pm;0.005)</td><td>47.076</td><td class="mismatch">47.052</td></tr><tr><td>十二</td><td>庚辰亥初二刻 (16.900&pm;0.005)</td><td>16.902</td><td>16.904</td></tr><tr><td rowspan="12">嘉靖十一年<br>(1532年)</td><td>正</td><td>庚戌酉初初刻 (46.713&pm;0.005)</td><td>46.716</td><td class="mismatch">46.743</td></tr><tr><td>二</td><td>庚辰巳正一刻 (16.432&pm;0.005)</td><td>16.435</td><td class="mismatch">16.478</td></tr><tr><td>三</td><td>庚戌子正三刻 (46.035&pm;0.005)</td><td>46.034</td><td class="mismatch">46.081</td></tr><tr><td>四</td><td>己卯午正一刻 (15.515&pm;0.005)</td><td>15.517</td><td class="mismatch">15.559</td></tr><tr><td>五</td><td>戊申亥初二刻 (44.900&pm;0.005)</td><td>44.899</td><td class="mismatch">44.927</td></tr><tr><td>六</td><td>戊寅卯初初刻 (14.213&pm;0.005)</td><td>14.213</td><td class="mismatch">14.225</td></tr><tr><td>七</td><td>丁未午正一刻 (43.515&pm;0.005)</td><td>43.519</td><td>43.513</td></tr><tr><td>八</td><td>丙子戌正初刻 (12.838&pm;0.005)</td><td>12.839</td><td class="mismatch">12.818</td></tr><tr><td>九</td><td>丙午卯初一刻 (42.223&pm;0.005)</td><td>42.218</td><td class="mismatch">42.186</td></tr><tr><td>十</td><td>乙亥申正一刻 (11.682&pm;0.005)</td><td>11.681</td><td class="mismatch">11.642</td></tr><tr><td>十一</td><td>乙巳卯正初刻 (41.255&pm;0.005)</td><td>41.253</td><td class="mismatch">41.216</td></tr><tr><td>十二</td><td>甲戌亥正一刻 (10.932&pm;0.005)</td><td>10.931</td><td class="mismatch">10.904</td></tr><tr><td rowspan="6"><a href="http://catalog.digitalarchives.tw/item/00/07/ec/cb.html" target="_blank">万历三十二年</a><br>(1604年)</td><td>正</td><td>壬子巳正三刻 (48.452&pm;0.005)</td><td>48.447</td><td class="mismatch">48.431</td></tr><tr><td>二</td><td>壬午寅正二刻 (18.192&pm;0.005)</td><td>18.190</td><td>18.192</td></tr><tr><td>三</td><td>辛亥亥正二刻 (47.942&pm;0.005)</td><td>47.939</td><td class="mismatch">47.961</td></tr><tr><td>四</td><td>辛巳未正三刻 (17.618&pm;0.005)</td><td>17.622</td><td class="mismatch">17.656</td></tr><tr><td>五</td><td>辛亥寅正?刻 (47.187&pm;0.021)</td><td>47.204</td><td class="mismatch">47.242</td></tr><tr><td>六</td><td>庚辰申正?刻 (16.687&pm;0.021)</td><td>16.677</td><td class="mismatch">16.709</td></tr><tr><td rowspan="12">万历四十四年<br>(1616年)</td><td>正</td><td>壬申申正三刻 (8.702&pm;0.005)</td><td>8.699</td><td>8.700</td></tr><tr><td>二</td><td>壬寅丑正二刻 (38.108&pm;0.005)</td><td>38.111</td><td class="mismatch">38.102</td></tr><tr><td>三</td><td>辛未午正三刻 (7.535&pm;0.005)</td><td>7.533</td><td class="mismatch">7.516</td></tr><tr><td>四</td><td>庚子夜子初三刻 (36.993&pm;0.005)</td><td>36.988</td><td class="mismatch">36.964</td></tr><tr><td>五</td><td>庚午午初二刻 (6.483&pm;0.005)</td><td>6.481</td><td class="mismatch">6.452</td></tr><tr><td>六</td><td>庚子子正三刻 (36.035&pm;0.005)</td><td>36.035</td><td class="mismatch">36.007</td></tr><tr><td>七</td><td>己巳申正一刻 (5.682&pm;0.005)</td><td>5.680</td><td class="mismatch">5.662</td></tr><tr><td>八</td><td>己亥巳初初刻 (35.380&pm;0.005)</td><td>35.384</td><td>35.381</td></tr><tr><td>九</td><td>己巳丑初三刻 (5.077&pm;0.005)</td><td>5.078</td><td class="mismatch">5.090</td></tr><tr><td>十</td><td>戊戌酉初三刻 (34.743&pm;0.005)</td><td>34.740</td><td class="mismatch">34.762</td></tr><tr><td>十一</td><td>戊辰辰正二刻 (4.358&pm;0.005)</td><td>4.354</td><td class="mismatch">4.382</td></tr><tr><td>十二</td><td>丁酉亥初三刻 (33.910&pm;0.005)</td><td>33.911</td><td class="mismatch">33.940</td></tr><tr><td rowspan="7"><a href="http://catalog.digitalarchives.tw/item/00/07/ec/d6.html" target="_blank">崇祯二年</a><br>(1629年)</td><td>正</td><td>丁巳戌初初刻 (53.797&pm;0.005)</td><td>53.801</td><td class="mismatch">53.820</td></tr><tr><td>二</td><td>丁亥未初二刻 (23.567&pm;0.005)</td><td>23.567</td><td class="mismatch">23.606</td></tr><tr><td>三</td><td>丁巳卯初初刻 (53.213&pm;0.005)</td><td>53.217</td><td class="mismatch">53.265</td></tr><tr><td>四</td><td>丙戌酉初三刻 (22.743&pm;0.005)</td><td>22.741</td><td class="mismatch">22.786</td></tr><tr><td>闰四</td><td>丙辰寅初三刻 (52.160&pm;0.005)</td><td>52.163</td><td class="mismatch">52.198</td></tr><tr><td>五</td><td>乙酉午初三刻 (21.493&pm;0.005)</td><td>21.494</td><td class="mismatch">21.513</td></tr><tr><td>六</td><td>甲寅酉正三刻 (50.785&pm;0.005)</td><td>50.785</td><td>50.786</td></tr><tr><td rowspan="6"><a href="http://catalog.digitalarchives.tw/item/00/07/ec/da.html" target="_blank">崇祯十二年</a><br>(1639年)</td><td>正</td><td>己未辰初一刻 (55.307&pm;0.005)</td><td>55.310</td><td>55.303</td></tr><tr><td>二</td><td>己丑丑正初刻 (25.088&pm;0.005)</td><td>25.089</td><td class="mismatch">25.105</td></tr><tr><td>三</td><td>戊午戌初三刻 (54.827&pm;0.005)</td><td>54.823</td><td class="mismatch">54.857</td></tr><tr><td>四</td><td>戊子巳正四刻 (24.4575&pm;0.0008)</td><td>24.4572</td><td class="mismatch">24.4988</td></tr><tr><td>五</td><td>丁巳夜子初二刻 (53.983&pm;0.005)</td><td>53.979</td><td class="error">54.019</td></tr><tr><td>六</td><td>丁亥巳初二刻 (23.400&pm;0.005)</td><td>23.400</td><td class="mismatch">23.429</td></tr></table><br><p>这计算结果十分漂亮，用D1算出的56个合朔时刻完全符合大统历书，D2的时刻虽然相差不远，但是大部分不符合历书的数据，其中崇祯十二年五月朔接近零时，D2的时刻偏差使朔日落在下一天。万历三十二年的历书有破损，五月朔和六月朔只知合朔的时辰而无法得知几刻，使合朔时刻只可确定在半个时辰内，但D2的时刻还是超出了这个时间范围。崇祯十二年历书载四月朔为巳正四刻，如上述，这资料使这合朔时刻范围缩小到2.4分钟内，而D1的计算结果就在这2.4分钟内，说明《大统历》确是按D1的算法计算定朔。</p><p>虽然D2的合朔时刻和D1相差不远，但是如果合朔很接近夜半零时可能会使朔日日期有一日之差，这情况在上述崇祯十二年五月朔出现。笔者用D2算出的明朝朔日与《三千五百年历日天象》的朔日比较，发现有88处不合，其中有21例找到了当年明朝的大统历书，发现D2算出的这21个朔日全错。用D1算出的朔日与《三千五百年历日天象》比较发现有11处不合，这11处不合改用D2来算仍然不合，也就是说上述那88处D2不合包括了这11个。上面的计算基本上证实了D1的推步方法就是那几部大统历书的推步方法，所以这11处不合很值得深入研究，下一节就探讨这个问题。</p><br><sect id="corrections">历 表 朔 日 订 正</sect><p>上一节的计算证实了《大统历》的定朔计算基本上沿用《授时历》的公式，只是除消了《授时历》的岁实消长法，结尾提到用此法算出的朔日在明朝二百七十六年间有11个朔日与《三千五百年历日天象》的数据不合。翻查薛仲三、欧阳颐的《两千年中西历对照表》<sup><a href="MingCalendar_simp.html#Hsueh"></a></sup>、陈垣的《二十史朔闰表》<sup><a href="MingCalendar_simp.html#Chen1962"></a></sup>及汪曰桢的<a href="https://ctext.org/library.pl?if=gb&res=2969&remap=gb" target="_blank">《历代长术辑要》</a>，发现三书所载的那十一个朔日也和《三千五百年历日天象》完全相同。笔者尝试寻找现存的大统历书核对，找到了其中七个朔日资料。令笔者惊讶的是，这七个朔日全都符合推步结果，也就是说那四本书的七个数据错了，余下的四个朔日因为找不到资料而无从判断，现把这十一个朔日列于下表。</p><br><table><caption style="text-align:left"><p>表二:历表、推步和大统历书的十一个朔日比较。《三千五百年历日天象》、《两千年中西历对照表》、《二十史朔闰表》和《历代长术辑要》四历表所列的这十一个朔日日期完全相同，红色字体表示朔日干支和《大统历》历书不合。推步方法用上一节的所说的D1(「迟疾限行度」)算法，数字整数部分表示日干支(0=甲子、1=乙丑等)，小数部分是朔小余。《大统历》历书栏里括号内注有该大统历书的来源。</p></caption><colgroup><col width="20%"><col width="10%"><col width="10%"><col width="35%"><col width="25%"><tr><th rowspan="2">年 份</th><th rowspan="2">月 份</th><th colspan="3">朔 日</th></tr><tr><th>历表</th><th>推步结果</th><th>《大统历》历书</th></tr><tr><td>洪武三年<br>(1370年)</td><td>二</td><td>庚申</td><td>57.0024 (辛酉, 子正初刻)</td><td></td></tr><tr><td>洪武十一年<br>(1378年)</td><td>八</td><td>辛丑</td><td>36.9827 (庚子, 夜子初二刻)</td><td></td></tr><tr><td>天顺六年<br>(1462年)</td><td>十一</td><td class="error">壬辰</td><td>27.8143 (辛卯, 戌初二刻)</td><td>辛卯 (黄一农 <a href="MingCalendar_simp.html#Huang1992b"></a>)</td></tr><tr><td>弘治八年<br>(1495年)</td><td>七</td><td>辛巳</td><td>18.1775 (壬午, 寅正一刻)</td><td></td></tr><tr><td>弘治十年<br>(1497年)</td><td>十</td><td>己巳</td><td>4.9997 (戊辰, 夜子初四刻)</td><td></td></tr><tr><td>万历九年<br>(1581年)</td><td>十</td><td class="error">壬辰</td><td>27.9349 (辛卯, 亥正一刻)</td><td>辛卯 (《汇编(三)》606页)</td></tr><tr><td rowspan="3">万历十六年<br>(1588年)</td><td>三</td><td class="error">癸未</td><td>20.4341 (甲申, 巳正一刻)</td><td>甲申 (<a href="http://catalog.digitalarchives.tw/item/00/07/ec/c9.html" target="_blank">典藏台湾</a>、《汇编(四)》135页)<a href="MingCalendar_simp.html#fn1"></a></td></tr><tr><td>四</td><td class="error">癸丑</td><td>50.0406 (甲寅, 子正四刻)</td><td>甲寅 (<a href="http://catalog.digitalarchives.tw/item/00/07/ec/c9.html" target="_blank">典藏台湾</a>、《汇编(四)》139页)<a href="MingCalendar_simp.html#fn1"></a></td></tr><tr><td>十二</td><td class="error">庚辰</td><td>15.9425 (己卯, 亥正二刻)</td><td>己卯 (《汇编(四)》175页)<a href="MingCalendar_simp.html#fn1"></a></td></tr><tr><td>万历二十八年<br>(1600年)</td><td>正</td><td class="error">乙巳</td><td>42.0834 (丙午, 丑正初刻)</td><td>丙午 (《汇编(四)》445页)</td></tr><tr><td>万历三十七年<br>(1609年)</td><td>正</td><td class="error">癸未</td><td>20.0211 (甲申, 子正二刻)</td><td>甲申 (《汇编(五)》67页)</td></tr></colgroup></table><br><p>不知为何各历书在万历十六年竟然有三个朔日错误。汪曰桢《历代长术辑要》在万历十六年注有「国榷十二己卯朔不合」，万历二十八年注有「国榷正丙午朔不合」，万历三十七年注有「国榷正甲申朔不合」。「国榷」是指谈迁(1594年-1658年)撰的明朝编年体史书，汪曰桢说的该书那三个朔日资料其实是正确的。但是《国榷》的资料也不可尽信，例如《历代长术辑要》在万历三十年注有「国榷九庚申朔不合」，在万历三十二年注有「国榷十二丁未朔不合」，这两个朔日确实和存世的大统历书不合(见《汇编(四)》510页及576页)。《历代长术辑要》在洪武三年注有「国榷二辛酉朔不合」，这朔日是表二所列的第一个朔日，《国榷》的资料虽然符合推步结果，但只能作为旁证。</p><p>从表中可见除了洪武三年二月朔和弘治十年十月朔非常接近午夜零时外，其余九个合朔都不是很接近日界，鉴于推步的结果至今还未发现与大统历书不符，笔者怀疑余下的四个朔日里，各历表的日期至少有两个有错。但是在找到可靠资料前，本网站的中历对这四个朔日日期仍以各历表为准。</p><br><hr><div id="references"><h2>参 考 文 献</h2><ul style="list-style-type:none"><li id="Zhang1997"><p><span class="ref"></span> 张培瑜，《三千五百年历日天象》，大象出版社，1997年7月。</p></li><li id="Hsueh"><p><span class="ref"></span> 薛仲三、欧阳颐，《两千年中西历对照表》，上海商务印书馆，民国29年(1940年)。</p></li><li id="Chen1962"><p><span class="ref"></span> 陈垣，《二十史朔闰表》，中华书局(北京)，1962年7月。</p></li><li id="compilation"><p><span class="ref"></span> 《国家图书馆藏明代大统历日汇编》(全六册)，本社古籍影印室编，北京图书馆出版社，2007年9月。</p></li><li id="Li2011"><p><span class="ref"></span> 李勇，「明嘉靖六年《大统历》历书的气朔推步精度」，天文学进展，29，218-227, 2011。</p></li><li id="Huang1992a"><p><span class="ref"></span> 黄一农，<a href="http://ccsdb.ncl.edu.tw/ccs/image/01_010_002_01_11.pdf" target="_blank">「中国史历表朔闰订正举隅 &mdash; 以唐《麟德历》行用时期为例」</a>，汉学研究，10，279-306，1992。</p></li><li id="LiZhang1996"><p><span class="ref"></span> 李勇、张培瑜，「中国古历定朔推步综述」，天文学进展，14，66-76，1996。</p></li><li id="LiZhang1998"><p><span class="ref"></span> Li, Y., Zhang, C.Z., <a href="https://ui.adsabs.harvard.edu/abs/1998A%26A...332.1142L/abstract" target="_blank">"Chinese syzygy calculation established in the 13th century"</a>, Astro. Astrophys., 332, 1142-1146 (1998).</p></li><li id="fn0"><p><span class="ref"></span> 典藏台湾的明代历书应是藏于台北中央图书馆善本书室，万历三十二年历书的编号是 6322，崇祯二年历书的编号是 6333，崇祯十二年历书的编号是 6337。历书的第二页应有下半年的合朔时刻，如有学者能提供这三部历书的第二页照片 (电邮 yuktungliu@gmail.com)，不胜感激。</p></li><li id="Huang1992b"><p><span class="ref"></span> 黄一农在<a href="http://ccsdb.ncl.edu.tw/ccs/image/01_010_002_01_11.pdf" target="_blank">「中国史历表朔闰订正举隅 &mdash; 以唐《麟德历》行用时期为例」</a>(汉学研究，10，279-306，1992)「绪言」一节道:</p><blockquote><p>笔者曾在台北中央图书馆善本书室发现一本未记年号的明代残历，编目为6294号，此历存四至十二月，经研析其内容后，知其应为英宗天顺六年(1462)历日，但该历记十一月为辛卯，而各历表中却同误为壬辰朔。</p></blockquote><p>他在注4中谈及如何推断历书年份:</p><blockquote><p>因此历记四月建乙巳、丙寅朔，且该月的九宫图以五黄为中宫，故由传统编历的规则可推知其年干为丁或壬，年支为子、午或酉，而在西元1000-1911年间，仅明英宗天顺六年壬午岁符合前述之年干及年支，且各月的朔日干支最接近残历…… 又，《明英宗睿皇帝实录》(京都:中文出版社，1984)中，乃以天顺六年十一月为壬辰朔(卷三四六页1)，亦与此历不合。</p></blockquote><p>此残历四月的首页可见于<a href="https://catalog.digitalarchives.tw/item/00/07/ec/b0.html" target="_blank">此典藏台湾网页</a>。</p></li><li id="fn1"><p><span class="ref"></span> 《汇编(四)》收藏的万历十六年大统历首二页破损严重，幸而各月朔日仍可从内页的日历查得。典藏台湾所示的万历十六年大统历首页则很完整，其照片应是来自台北中央图书馆善本书室编号6319的明代历书，好古者可到台北中央图书馆查阅此书，估计第二页也很清晰。</p></li></ul></div><br><br></div><noscript><h2>抱 歉!</h2><p>本网页需要用 JavaScript 才能正确显示。</p><p>请在浏览器中启用 JavaScript 后再进入本网页。</p></noscript><script>let i,j;document.getElementById("wrapper0").style.display="block",header(2,"","MingCalendar");let ref=document.querySelectorAll("#references li"),refn=document.querySelectorAll("#references .ref"),n=refn.length;for(i=0;i<n;i++)refn[i].innerHTML="["+(i+1)+"]";let cita=document.querySelectorAll("a");n=cita.length;let r=ref.length;for(i=0;i<n;i++)for(j=0;j<r;j++)if(cita[i].href.includes("#"+ref[j].id)){cita[i].innerHTML="["+(j+1)+"]";break}</script></body></html>